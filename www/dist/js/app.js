var kupavnaApp=function(){var t=function(){function t(){try{return document.createEvent("TouchEvent"),!0}catch(t){return!1}}t()?$("body").addClass("touch"):$("body").removeClass("touch")},n=function(){var t=$("#to-top"),n=!1;$(window).on("scroll",function(e){(window.pageYOffset||document.scrollTop)-(document.clientTop||0)>300?n||(t.addClass("is-show"),n=!0):n&&(t.removeClass("is-show"),n=!1)}),t.on("click",function(){s(0,300)})},e=function(){var t=$("#catalog-nav-header"),n=function(){t.children(".btn").removeClass("hover")};t.on("mouseenter",".catalog-nav-menu > li",function(){t.find(".catalog-nav-menu > li").removeClass("current"),t.find(".catalog-nav-show").html($(this).children("ul").clone()),$(this).addClass("current")}),t.on("mouseenter",".btn",function(){$(this).addClass("hover"),t.find(".catalog-nav-menu > li").eq(0).trigger("mouseenter")}),t.on("mouseleave",".btn",function(){t.find(".catalog-nav-wrap").filter(":hover").length||n()}),t.on("mouseleave",".catalog-nav-wrap",n),t.find(".catalog-nav-show").css("height",t.find(".catalog-nav-menu").innerHeight())},i=function(){$("#header-nav").children("li").each(function(){$(this).find("ul").length&&$(this).addClass("hover")})},o=function(){$(".filter .name").on("click",function(t){var n=$(this).closest(".filter");n.hasClass("open")?(n.find(".wrap").animate({height:0},100),n.removeClass("open")):n.addClass("open").find(".wrap").animate({height:n.find(".items").innerHeight()},100,function(){$(this).removeAttr("style")})}).eq(0).closest("form").on("submit",function(){var t=$(this),n=window.location.search.substring(1),e=function(n,e){var i=t.find("input[name="+n+"]");i.length?i.val(e):(i=$("<input />",{type:"hidden",name:n,value:e}),t.append(i))};try{n=JSON.parse('{"'+decodeURI(n).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}'),$.each(n,function(t,n){e(t,n)})}catch(i){}})},a=function(){function t(t){var n=0;return t.each(function(){n+=$(this).height()}),n}$(".filter").each(function(){var n=$(this),e=null;return n.find(".checkbox").length>5?(e=n.find(".checkbox"),n.find(".checkbox-group").data("height",n.find(".checkbox-group").height()),n.find(".checkbox-group").height(t(e.slice(0,5))),n.find(".toggle-checkbox-group").addClass("show"),void n.on("click",".toggle-checkbox-group",function(){var n=$(this),e=n.closest(".filter").find(".checkbox-group");if(n.hasClass("checkbox-group--state-open")){var i=0,o=e.find('input[type="checkbox"]:checked');o.length&&(i=t(e.find(".checkbox").slice(0,Math.max(5,o.eq(-1).closest(".checkbox").index()+1)))),e.animate({height:i},100),n.removeClass("checkbox-group--state-open").text("Показать ещё")}else e.animate({height:e.data("height")},100),n.addClass("checkbox-group--state-open").text("Свернуть список")})):void(n.find(".checkbox-tag-group").height()>78&&(n.find(".checkbox-tag-group").data("height",n.find(".checkbox-tag-group").height()),n.find(".checkbox-tag-group").height(78),n.find(".toggle-checkbox-group").addClass("show"),n.on("click",".toggle-checkbox-group",function(){var t=$(this),n=t.closest(".filter").find(".checkbox-tag-group");t.hasClass("checkbox-group--state-open")?(n.animate({height:78},100),t.removeClass("checkbox-group--state-open").text("Показать ещё")):(n.animate({height:n.data("height")},100),t.addClass("checkbox-group--state-open").text("Свернуть список"))})))})},c=function(t,n,e){function i(){var t=location.search.substr(1),n=[];return t.split("&").forEach(function(t){var e=t.split("="),i={};i[e[0]]=decodeURIComponent(e[1]),n.push(i)}),n}t.each(function(){var t=$(this);t.find(n).each(function(){var n=$(this),o=n.find('input[type="checkbox"]');$.each(i(),function(i,a){encodeURI(o.attr("name"))==Object.keys(a)[0]&&o.attr("value")==a[Object.keys(a)[0]]&&(o.prop("checked",!0),e||t.prepend(n))})})})},s=function(t,n){t=t||Number(0),n=Number(n)||1e3,$("html,body").animate({scrollTop:t},n)},r=function(t,n){var e=t.find(".content");e.height()>n&&(t.data("is-toggle",!0),e.data("originHeight",e.height()).css("height",n),t.find(".show-btn").addClass("show"))},h=function(){$("body").on("click",".notice",function(t){t.preventDefault(),t.stopPropagation(),$(this).closest(".notice").fadeOut(function(){$(this).remove()})})};return{init:function(){$(document).foundation(),t(),n(),e(),i(),h()},filter:function(){a(),o()},resetFilter:function(){return window.location.href=window.location.href.replace(/\?.*/,""),!1},anchorToBlock:function(){$("body").on("click",".anchor-to-block",function(t){t.preventDefault(),t.stopPropagation();var n=$(this.hash),e=Number($(this).data("offset"))||Number(0),i=$(this).data("speed");if(n=n.length?n:$("[name="+this.hash.slice(1)+"]"),n.length)return s(n.offset().top+e,i),!1})},anchorToTab:function(){$("body").on("click",".anchor-to-tab",function(t){t.preventDefault(),t.stopPropagation(),$($(this).data("tab-href")).trigger("click")})},markCheckboxOnGetParams:function(t,n,e){c(t,n,e)},dotText:function(){$(".dot-text").each(function(){var t=$(this);t.find(".text").dotdotdot({height:t.data("height"),callback:function(n){if(n){if("... "===t.find(".text").html().slice(-4)){var e=t.find(".text").children();t.find(".text").empty().append(e)}t.find(".show").addClass("visible").on("click",function(){var n=t.find(".show"),e=n.data("alt-text");n.data("alt-text",n.find("span").text()),n.toggleClass("is-open").find("span").text(e),t.find(".text").data("dotdotdot")?t.find(".text").trigger("isTruncated",function(n){n&&t.find(".text").trigger("destroy")}):t.find(".text").dotdotdot({height:t.data("height"),callback:function(n){if(n&&"... "===t.find(".text").html().slice(-4)){var e=t.find(".text").children();t.find(".text").empty().append(e)}}})})}}})})},gallery:function(){$(".gallery-widget").each(function(){var t=$(this);t.find(".slider-content").on("init",function(){t.find(".thumbs").append(t.find(".slick-dots").addClass("clearfix")).customScrollbar({updateOnWindowResize:!0})}).slick({prevArrow:'<div class="slick-arrow slick-prev"><div class="button radial"><svg class="icon-arrow"><use xlink:href="#icon-arrow"></use></svg></div></div>',nextArrow:'<div class="slick-arrow slick-next"><div class="button radial"><svg class="icon-arrow slick-next transform-180"><use xlink:href="#icon-arrow"></use></svg></div></div>',dots:!0,customPaging:function(t,n){return'<img src="'+$(t.$slides[n]).data("thumb")+'">'}})})},tabsLink:function(){$(".tabs-link").on("click","a",function(){return"#"!=$(this).attr("href")&&void(window.location.href=this.href)})},initPhoneMask:function(){$(".phone-mask").each(function(){var t=$(this);t.mask(t.data("mask")||"+7 (999) 999-99-99")})},showToggle:function(t,n,e){var i=$(t);return e?(i.each(function(){var t=$(this);t.data("is-toggle")||(t.find(".show-btn").removeClass("show"),t.find(".content").css("height","auto"),r(t,n))}),!1):void i.each(function(){r($(this),n)}).on("click",".show-btn",function(){var e=$(this),i=e.closest(t),o=e.data("text");i.hasClass("open")?i.removeClass("open").find(".content").animate({height:n}):i.addClass("open").find(".content").animate({height:i.find(".content").data("originHeight")}),e.data("text",e.find("span").text()).find("span").text(o)})},noticeText:"Данного товара больше нет в наличии, но он доступен под заказ!",appendNotice:function(t){t.append('<div class="notice"><div class="notice__text">'+kupavnaApp.noticeText+'</div> <div class="notice__confirm">Хорошо</div> </div> ')}}}();$(document).ready(function(){kupavnaApp.init(),kupavnaApp.initPhoneMask(),$(document.body).on("click",'a[href="#"]',function(t){return t.preventDefault(),t.stopPropagation(),!1})});